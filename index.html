<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Canvas</title>
    <style>
      * { padding: 0; margin: 0; }
      canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width="480" height="320"></canvas>

    <script>
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");
      var floor = canvas.height;

      let gravity = {
          strength: 4,
          moveBall: function(bal) {
              if (ball.y < floor - ball.radius) {
                  ball.y += gravity.strength;
              }
          }
      }

      let ball = {
          x: 0,
          y: floor - 10,
          radius: 10,
      }
      
      let advertising = {
          x: ball.radius,
          y: floor,
          hypefactor: 10 * 30,
          time: 30,
          touching: function (ball) {
              return (ball.x >= (this.x - ball.radius)) && (ball.x <= this.x+this.time+ball.radius) && (ball.y > (floor - (this.hypefactor + ball.radius)));
          },
          moveBall: function (ball) {
              ball.y = ball.y - (this.hypefactor / this.time);
          }
      };

      function drawAdvertising(ad) {
          drawTriangle(ad.x, ad.y, ad.time, ad.hypefactor, 1);
      }

      function navigate(ball, ad) {
          if (ad.touching(ball)) {
              ad.moveBall(ball);
          } else {
              gravity.moveBall(ball);
          }
          if (ball.x < (canvas.width - ball.radius)) {
              ball.x += 1;
          } else {
              clearInterval(interval);
          }
      }
      
      function drawTriangle(x, y, width, height, growth){
          ctx.beginPath();
          ctx.moveTo(x, y);
          if (growth > 0) {
              ctx.lineTo(x+width, y-height);
              ctx.lineTo(x+width, y);
              ctx.lineTo(x, y);
          } else {
              ctx.lineTo(x, y-height);
              ctx.lineTo(x+width, y);
              ctx.lineTo(x, y);
          }
          ctx.fillStyle = "#fedfed";
          ctx.fill();
          ctx.closePath();
      }

     function drawBall(ball) {
          ctx.beginPath();
          ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
          ctx.fillStyle = "#0095DD";
          ctx.fill();
          ctx.closePath();
      }
 
      function draw(ball, ad) {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          drawAdvertising(ad);
          console.log(ball.x, ball.y)
          drawBall(ball);
      }

      function frame() {
          navigate(ball, advertising);
          draw(ball, advertising);
      }
      var interval = setInterval(frame, 10);

    </script>

  </body>
</html>
